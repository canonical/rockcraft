project: craft-test

backends:
  craft:
    systems:
      - ubuntu-22.04:
          workers: 1

suites:
  spread-tests/:
    summary: basic tests

prepare: |
  sudo snap install docker

  # For 'rockcraft.skopeo'
  sudo snap install --classic rockcraft

  # Wait for docker daemon to come online
  sudo apt install --yes retry
  retry --times=10 --delay 2 -- docker run hello-world

restore: |
  # Other tests use 'retry' from snapd-testing-tools
  sudo apt remove --yes retry
