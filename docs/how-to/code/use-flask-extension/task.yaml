###########################################
# IMPORTANT
# Comments matter!
# The docs use the wrapping comments as 
# markers for including said instructions 
# as snippets in the docs.
###########################################
summary: test the "Use the flask-framework extension" guide

execute: |
  cd example
  # [docs:logs-app-setup-start]
  rockcraft pack
  sudo rockcraft.skopeo --insecure-policy copy oci-archive:example-flask_0.1_amd64.rock docker-daemon:example-flask:0.1
  sudo docker run -d -p 8000:8000 --name example-flask example-flask:0.1
  # [docs:logs-app-setup-end]
  # [docs:logs-app-start]
  sudo docker exec example-flask pebble logs flask
  # [docs:logs-app-end]
  sudo docker stop example-flask
  sudo docker rm example-flask
  sudo docker rmi example-flask:0.1
  cd -

restore: |
  rm -rf */*.rock
